<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <![endif]-->
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Evelien Admission</title>
        <meta name="keywords" content="Art School, Admission, Portfolio, Project">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="admission.css">
    </head>

    <body>
        <section class="section-1">
            <h2>Section 1</h2>
        </section>
        <section class="section-2">
            <h2>Section 2</h2>
        </section>
        <section class="section-3">
            <h2>Section 3</h2>
        </section>
        <section class="section-4">
            <div class="top-banner" id="top"></div>
            <div class="left-banner" id="left"></div>
            <div class="right-banner" id="right"></div>
            <div class="bottom-banner" id="bottom"></div>
        </section>
        <section class="section-5">
            <img class="sticky-panel" src="me_when.jpg" alt="A crowd of protestors" />
        </section>
        <section class="section-6">
            <img class="sticky-panel" src="me_when.jpg" alt="A crowd of protestors zoomed out fully" />
        </section>
    </body>
</html>

<script>
    window.onload = function () {
        document.getElementById("left").style.left = "0vw";
    }

    window.onscroll = function () {
        var offsetToSection5 = section5.getBoundingClientRect();
        var top5 = offsetToSection5.top;
        var newVH = window.innerHeight;
        var newVW = window.innerWidth;
        offsetProgress = top5 / newVH;
        width = document.getElementById("left").offsetWidth;
        newLeft = (100 * offsetProgress * width / newVW - 31.333)
        //if bigger than 0, set to 0
        if (newLeft > 0) {
            newLeft = 0;
        }
        if (newLeft < -20) {
            newLeft = -20;
        }
        document.getElementById("left").style.left = newLeft.toString() + "vw";

        //console.log(top5);
        //from top5 being vh to 0, do the cinema scroll
        //above vh, set max (1), below 0 set min (0)
        //functions negate the x attribute in x-banner in section 4

        var offsetToSection6 = section6.getBoundingClientRect();
        var top6 = offsetToSection6.top;
        //console.log(top6);
        //from top6 being vh to 0, do the zoom. maybe add another section if scroll is too fast
        //above vh, set max (1), below 0 set min (0)
        //function zoom img in section 4
    }

    function scrollLeftBar(offset) {
        document.getElementById("left").style.left = "-20vw";
    }


    function scrollLeft(entries, o) {
        entries.forEach(entry => {
            entry.target.style.left = (-1 * entry.target.getBoundingClientRect().top / window.innerHeight * leftbar.offsetWidth).toString + "px;";
            //console.log(entry.target.getBoundingClientRect().top);
            //console.log(entry.target.getBoundingClientRect().window.innerHeight);
            //console.log(entry.target.getBoundingClientRect().leftbar.offsetWidth);
        })
    }

    function scrollRight(entries) {
        entries.forEach(entry => {
            r = entry.intersectionRatio
            console.log(entry);
            document.getElementById("right").transform = 'rotate(' + r + 'turn);';
        })
    }
    
    const section4   = document.querySelector("section.section-4");
    const section5   = document.querySelector("section.section-5");
    const section6   = document.querySelector("section.section-6");
    const leftBanner = document.querySelector("div.left-banner");

    const viewportCollider = {
        root: null, //default; browser viewport, targets intersectional element
        threshold: 1, //default; 0, percentage of target that should be visible
        rootMargin: "0px", //margin difference from threshold
    }

    const gradualOverlay = {
        root: null, //default; browser viewport, targets intersectional element
        threshold: [0, 0.25, 0.5, 0.75, 1.0], //default; 0, percentage of target that should be visible
        rootMargin: "0px", //margin difference from threshold
    }

    const leftbarScroller = new IntersectionObserver(scrollLeft, gradualOverlay);
    leftbarScroller.observe(section5);



    //current implementation plan

    //observer for sidebars and section 3 intersection, to gradually go offscreen.
    //  use transform margin / total width times "entry.intersectionRatio" variable so scrolling back up reverses the process
    //

    //use two sections that zoom out the total crowd img when scrolled over with sticky. 

    //resources consulted:
    //  https://daveyhert.medium.com/revealing-contents-on-scroll-using-javascripts-intersection-observer-api-ab09f4faec77
    //  https://blog.webdevsimplified.com/2022-01/intersection-observer/

</script>

